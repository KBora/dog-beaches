var dogBeachInitialData=[{title:"Sirius Cove",position:{lat:-33.839502,lng:151.237244},offLeash:!0,offLeashTimes:"All day Monday to Friday, and before 9am and after 4pm on Saturdays, Sundays and Public Holidays ",website:"http://www.mosman.nsw.gov.au/residents/Pets/where-to-walk-your-dog/"},{title:"Clifton Gardens",position:{lat:-33.838516,lng:151.254275},offLeash:!0,offLeashTimes:"Before 9am and after 4pm weekdays during winter. Before 9am and after 6pm weekdays during daylight savings summer months (Oct â€“ Mar)",website:"http://www.mosman.nsw.gov.au/residents/Pets/where-to-walk-your-dog/"},{title:"Dumaresq Reserve",position:{lat:-33.866418,lng:151.270572},offLeash:!0,offLeashTimes:"Between 4.30pm and 8.30am",website:"http://www.woollahra.nsw.gov.au/services/animals_and_pets/walking_your_dog"},{title:"Rowland Reserve",position:{lat:-33.660741,lng:151.305761},offLeash:!0,offLeashTimes:"All times",website:"http://www.pittwater.nsw.gov.au/property/domestic_animals/dogs/exercise_areas"},{title:"Flora and Richie Roberts Reserve",position:{lat:-33.766673,lng:151.298436},offLeash:!0,offLeashTimes:"All times",website:"http://www.warringah.nsw.gov.au/play/flora-and-ritchie-roberts-reserve"},{title:"Bonna Point Reserve",position:{lat:-34.007235,lng:151.190262},offLeash:!0,offLeashTimes:"All times",website:"http://www.sutherlandshire.nsw.gov.au/Outdoors/Parks-and-Playgrounds/Parks/Bonna-Point-Reserve-Kurnell"},{title:"Bondi to Bronte coastal walk",position:{lat:-33.895492,lng:151.274602},offLeash:!1,offLeashTimes:"Dogs must be on a leash",website:"http://www.waverley.nsw.gov.au/recreation/beaches_and_coast/bondi_to_bronte_coastal_walk"}],DogBeachMarker=function(e){var a=this;a.googleMarker=new google.maps.Marker({position:e.position,map:map,title:e.title}),a.matchesFilter=ko.observable(!0),a.offLeash=e.offLeash,a.offLeashTimes=e.offLeashTimes,a.website=e.website},ViewModel=function(){function e(e){return function(){i.listVisible()&&i.toggleList(),t(e.googleMarker),s.setContent(a(e)),s.open(map,e.googleMarker),o(e)}}function a(e){var a="<h3>"+e.googleMarker.title+"</h3>";a+='<div class="infoHeading">Off Leash Times</div>',a=a+'<div class="off-leash-description">'+e.offLeashTimes+"</div>",a+='<div class="infoHeading">Flickr Image</div><div class="flickr-images"><img src="img/running-dog-grey.gif"><br>Loading ...</div>';var o='<div class="infoHeading">Council website</div><a href="'+e.website+'">'+e.website+"</a>";return a+o}function o(e){var a="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=eebfb336fe500c5469321951f38d7853&tags="+e.googleMarker.title+"&per_page=1&format=json&jsoncallback=?",o="";$.ajax({url:a,dataType:"jsonp"}).done(function(e){for(var a=e.photos.photo,t=0;t<a.length;t++){var i="https://farm"+a[t].farm+".staticflickr.com/"+a[t].server+"/"+a[t].id+"_"+a[t].secret+"_m.jpg";o='<img src="'+i+'" class="info-window-image">',$(".flickr-images").html(o)}}).error(function(){o="Cannot load Flickr images at this time."}).complete(function(){$(".flickr-images").html(o)})}function t(e){e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.setAnimation(null)},3500)}var i=this;i.dogBeaches=ko.observableArray([]);var s=new google.maps.InfoWindow({content:"default info window text",maxWidth:350});dogBeachInitialData.forEach(function(a){var o=new DogBeachMarker(a);o.clickMarker=e(o),o.googleMarker.addListener("click",o.clickMarker),i.dogBeaches.push(o)}),i.query=ko.observable(""),i.dogBeachesFiltered=ko.computed(function(){var e=i.query().toLowerCase();return e?ko.utils.arrayFilter(this.dogBeaches(),function(a){var o=-1!==a.googleMarker.title.toLowerCase().indexOf(e);return a.googleMarker.setVisible(o),o}):this.dogBeaches()},i),i.listVisible=ko.observable(!1),i.listToggleButtonText=ko.computed(function(){return i.listVisible()?"HIDE LIST":"SHOW LIST"},i),i.toggleList=function(){i.listVisible(!i.listVisible())}};