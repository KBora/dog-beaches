var dogBeachInitialData=[{title:"Sirius Cove",position:{lat:-33.839502,lng:151.237244},offLeash:!0,offLeashTimes:"All day Monday to Friday, and before 9am and after 4pm on Saturdays, Sundays and Public Holidays ",website:"http://www.mosman.nsw.gov.au/residents/Pets/where-to-walk-your-dog/"},{title:"Clifton Gardens",position:{lat:-33.838516,lng:151.254275},offLeash:!0,offLeashTimes:"Before 9am and after 4pm weekdays during winter. Before 9am and after 6pm weekdays during daylight savings summer months (Oct â€“ Mar)",website:"http://www.mosman.nsw.gov.au/residents/Pets/where-to-walk-your-dog/"},{title:"Dumaresq Reserve",position:{lat:-33.866418,lng:151.270572},offLeash:!0,offLeashTimes:"Between 4.30pm and 8.30am",website:"http://www.woollahra.nsw.gov.au/services/animals_and_pets/walking_your_dog"},{title:"Rowland Reserve",position:{lat:-33.660741,lng:151.305761},offLeash:!0,offLeashTimes:"All times",website:"http://www.pittwater.nsw.gov.au/property/domestic_animals/dogs/exercise_areas"},{title:"Flora and Richie Roberts Reserve",position:{lat:-33.766673,lng:151.298436},offLeash:!0,offLeashTimes:"All times",website:"http://www.warringah.nsw.gov.au/play/flora-and-ritchie-roberts-reserve"}],DogBeachMarker=function(e){var i=this;i.googleMarker=new google.maps.Marker({position:e.position,map:map,title:e.title}),i.matchesFilter=ko.observable(!0),i.offLeash=e.offLeash,i.offLeashTimes=e.offLeashTimes,i.website=e.website},ViewModel=function(){function e(e){return function(){t.listVisible()&&t.toggleList(),o(e.googleMarker),s.setContent(i(e)),s.open(map,e.googleMarker),a(e)}}function i(e){var i="<h3>"+e.googleMarker.title+"</h3>";i+='<div class="infoHeading">Off Leash Times</div>',i=i+'<div class="off-leash-description">'+e.offLeashTimes+"</div>",i+='<div class="infoHeading">Flickr Image</div><div class="flickr-images"><img src="img/running-dog-grey.gif"><br>Loading ...</div>';var a='<div class="infoHeading">Council website</div><a href="'+e.website+'">'+e.website+"</a>";return i+a}function a(e){var i="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=eebfb336fe500c5469321951f38d7853&tags="+e.googleMarker.title+"&per_page=1&format=json&jsoncallback=?",a="";$.ajax({url:i,dataType:"jsonp"}).done(function(e){for(var i=e.photos.photo,o=0;o<i.length;o++){var t="https://farm"+i[o].farm+".staticflickr.com/"+i[o].server+"/"+i[o].id+"_"+i[o].secret+"_m.jpg";a='<img src="'+t+'" class="info-window-image">',$(".flickr-images").html(a)}}).error(function(){a="Cannot load Flickr images at this time."}).complete(function(){$(".flickr-images").html(a)})}function o(e){e.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){e.setAnimation(null)},3500)}var t=this;t.dogBeaches=ko.observableArray([]);var s=new google.maps.InfoWindow({content:"default info window text",maxWidth:350});dogBeachInitialData.forEach(function(i){var a=new DogBeachMarker(i);a.clickMarker=e(a),a.googleMarker.addListener("click",a.clickMarker),t.dogBeaches.push(a)}),t.query=ko.observable(""),t.dogBeachesFiltered=ko.computed(function(){var e=t.query().toLowerCase();return e?ko.utils.arrayFilter(this.dogBeaches(),function(i){return-1!==i.googleMarker.title.toLowerCase().indexOf(e)}):this.dogBeaches()},t),t.listVisible=ko.observable(!1),t.listToggleButtonText=ko.computed(function(){return t.listVisible()?"HIDE LIST":"SHOW LIST"},t),t.toggleList=function(){t.listVisible(!t.listVisible())}};